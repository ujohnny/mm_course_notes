Лекци 9
=======

Вот есть у нас, например, дерево поиска. А давайте посчитаем, за сколько же в
среднем мы будем искать в нём некий элемент.



Определение: **количество точек роста вершины** - количество поддеревьев,
которые можно подвесить к вершине. По-сути, выражается формулой $2 - deg(v)$.
Что такое **точка роста** - сами догадаетесь.

//  тут были выписаны всевозможные деревья поиска для чисел [1, 2, 3].
//  Возможно,  
//  они как-то связаны с некоторыми перестановками, но я не понял, как.



$T_n$ - множество деревьев из $n$ вершин

$t \in T_n$ - конкретное деревце

$m_t(i)$ - число вершин на i-м уровне в дереве t

$m(n, i) = \sum_{t \in T_n} m_t(i)$ - количество вершин на i-м уровне у всех
деревьев

$q_t(i)$ - число точек роста на $i$-м уровне у дерева $t$

$q(n, i) = \sum_{t \in T_n} q_t(i)$ - тоже самое, по всем деревьям



### Пронаблюдаем забавные свойства

$m(n, 1) = n!$ ибо сумма по всем деревьям.

$m(n, i) = 2 m(n, i) - q(n, i-1)$

$m(n+1, i) = (n+1) m(n, i) + q(n, i-1)$ тут коэффициент (n+1) ибо столько точек
роста



А вот ещё рекуррентное соотношение

$$
m(n, 1) = n!
$$

$$
m(n+1, i) = n m(n, i) + 2 m(n, i-1), i > 0
$$



$K_t = \frac{1}{n} \sum_{i=1}^n i m_t(i)$ - среднее время доступа к элементу в
дереве $t$

$K(n) = \frac{1}{n!} \sum_{t \in T_n} K_t$ - понятно

Очевидно, что $K(n) = \frac{n n!} \sum_{k=1}^n i m(n, i)$



А теперь... рекуррентное соотношение!!1

$K(n) = \frac{(n-1)(n+1)}{n!} K(n-1) + \frac{2n-1}{n^2}$

$K(n) = \frac{2(n+1)}{n} H_n - 3$

Это выводится из рекуррентного же определения $m(n+1, i)$, но нам не
рассказывалось.

Отсюда $K(n) = O(\log_2 n)$



Пляшем дальше:

$P_t = \sum_{i=1}^n (i-1) m_t(i)$ - среднее время построения дерева $t$

$P_t = \sum_{i=1}^n i m_t(i) - \sum_{i=1}^n m_t(i) = n K_t - n$

$P(n) = \frac{1}{n!} \sum_{t \in T_n} P_t$ - среднее время построения дерева из
n вершин

Ну отсюда ясно, что $P(n) = 2(n+1) \sum_{k=1}^n \frac{1}{k} - 4n \Rightarrow n
\log_2 n$





А ещё деревья какие бывают? Ну, например:

-   **Бинарные**: это такие, где у каждой вершины от 0 до 2 потомков. Их
    количество равно числу Каталана, т.е. $\frac{1}{n+1} C_{2n}^n$

-   **Упорядоченные**: несколько потомков в правильном порядке. Утвеждается, что
    существует биекция между упорядоченными деревьями и бинарными.

-   **Помеченные деревья**: дерево, чьи вершины помечены. Теорема Кэли:
    $n^{n-2}$

-   **Коревые помеченные деревья**:

-   **Топологические деревья**: вершины не помечены, а топологическая структура
    - дерево.



А теперь обо всем более конкретно:

$C_n$ - число бинарных деревьев с n вершинами.

К.О. докладывае: $C_0 = 1$ (пустых деревьев один штук), $C_1 = 1$, $C_n =
\sum_{k=0}^n C_k C_{n-k}$

Рассмотрим

$$
C(x) := \sum_{n=0}^\infty C_n x^n
$$

Из соотношения имеем $C(x) = x C^2(x) + 1$ это квадратная функция, отсюда $C(x)
= \frac{1 \pm \sqrt{1 - 4x}}{2x}$
